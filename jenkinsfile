pipeline {
    agent any

    stages {

        stage('compile') {
            steps {
                echo 'complie'
                sh 'mvn compile'
            }
        }

        stage('mvn build') {
            steps {
                echo "build project"
                sh 'mvn -Dmaven.test.skip=true clean package'
            }
        }
/*        stage('test') {
            steps {
                echo "Tests"
                sh 'mvn test'

            }

        }


        stage('install') {
            steps {
                echo 'install
                sh 'mvn  -DskipTest clean install '

            }

        }*/

 /*       stage('Dokcer build image') {
            steps {
                script {
                    sh 'docker build -t chaieb/tpachatprojecttest-1.0 -f Dockerfile .'

                    //dockerImage = docker.build registry + ":$BUILD_NUMBER"
                }
            }
        }*/
        stage('Dokcer push') {
            steps {
                script {
                    withCredentials([string(credentialsId: 'dockerhubpwd', variable: 'dockerhubpwd')]) {
                        sh 'docker login -u chJasser -p ${dockerhubpwd}'
                        sh 'docker push chaieb/tpachatprojecttest-1.0 '
                    }


                }
            }
        }


    }
    post {

        failure {
            emailext to: "cjasser40@gmail.com",
                    subject: "jenkins build:${currentBuild.currentResult}: ${env.JOB_NAME}",
                    body: "${currentBuild.currentResult}: Job ${env.JOB_NAME}\nMore Info can be found here: ${env.BUILD_URL}",
                    attachLog: true
        }

    }
}